|   |   |
|---|---|
|API call with token|let<br><br>Â Â Â  url = "[https://postgrest-camunda-dev.oak.in.ua/workload"](https://postgrest-camunda-dev.oak.in.ua/workload%22),<br><br>Â Â Â  headers = [#"Authorization" = "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoicmFjY2VzcyJ9.ppTyrI17E3L456eVlAun8BML4mwzn7sYh0h8h5jkXDQ"],<br><br>Â Â Â  response = Web.Contents(<br><br>Â Â Â Â Â Â Â  url,<br><br>Â Â Â Â Â Â Â  [<br><br>Â Â Â Â Â Â Â Â Â Â Â  Headers = headers<br><br>Â Â Â Â Â Â Â  ]<br><br>Â Â Â  ),<br><br>Â Â Â  jsonResponse = Json.Document(response),<br><br>Â Â Â  #"Converted to Table" = Table.FromRecords(jsonResponse)<br><br>in<br><br>Â Â Â  #"Converted to Table"|
|Fn__DatereRreshed|()=><br><br>= DateTimeZone.ToText( DateTimeZone.SwitchZone( DateTimeZone.FixedUtcNow(), 2 ), [Format="dd-mm-yyyy HH:mm"])|
|Create empty Table|#table(<br><br>Â  Â  Â Get_OPO_Pers_ColNames , Â  Â // list of ColNames<br><br>Â  Â  Â {<br><br>Â  Â  Â  Â  List.Repeat({null}, List.Count(Get_OPO_Pers_ColNames))<br><br>Â  Â  Â } // each record represents a row<br><br>)|
|Fn_ReplaceListOfValsInDiffCollumns<br><br>(based on List Accumulate)a|(_T_sourceTable, __oldValParam as list, __newValParam as list, __columnsToReplValParam as list) as table =><br><br>let<br><br>Â  Â  __oldValues = __oldValParam,<br><br>Â  Â  __newValues = __newValParam,<br><br>Â  Â  __mappingTable = Fn_BulkRenameColumns( Table.Transpose( Table.FromRows({__oldValues, __newValues})), {"Column1", "Column2"}, {"Old", "New"}),<br><br>Â  Â  __columnsToProcess = __columnsToReplValParam,<br><br>Â  Â  LA = List.Accumulate(<br><br>Â  Â  Â  Â  Table.ToRecords(__mappingTable) , //enum == iteration object<br><br>Â  Â  Â  Â  _T_sourceTable, Â  Â  Â  Â  Â  Â  Â  Â  Â  // seed == StartingTable Â  Â  Â <br><br>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // function Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <br><br>Â  Â  Â  Â  (OutputTable, oldNewPair)=><br><br>Â  Â  Â  Â  (<br><br>Â  Â  Â  Â  Â  Â  Table.ReplaceValue(OutputTable, oldNewPair[Old], oldNewPair[New], Replacer.ReplaceValue, __columnsToProcess )<br><br>Â  Â  Â  Â  )<br><br>)<br><br>in<br><br>Â  Â  LA|
|Parse all API response in one step (with List Accumulate)|List.Accumulate(<br><br>Â  Â  __tableFieldsList,<br><br>Â  Â  #"ğŸ’½â¬Exp fields",<br><br>Â  Â  (outTable, colName)=>(<br><br>Â  Â  Â  Â  Table.TransformColumns(outTable,<br><br>Â  Â  Â  Â  Â  Â  {{colName, (val)=>(<br><br>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if val = null then null else<br><br>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if Type.Is(Value.Type(val), type list) then Text.Combine(val, ",") else<br><br>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if Type.Is(Value.Type(val), type record) and Record.HasFields(val, {"value"}) then val[value] else<br><br>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if Type.Is(Value.Type(val), type record) and Record.HasFields(val, {"name"}) then val[name] else<br><br>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  val<br><br>Â  Â  Â  Â  Â  Â  Â  Â  )}}<br><br>Â  Â  Â  Â  )<br><br>Â  Â  )<br><br>)|
|Function to count occurrence in text<br><br>From <[https://stackoverflow.com/questions/44268075/is-there-a-simple-way-to-count-occurences-of-one-text-string-within-another-text](https://stackoverflow.com/questions/44268075/is-there-a-simple-way-to-count-occurences-of-one-text-string-within-another-text)>|(_string, _stringPart) =><br><br>List.Count(Text.Split(_string,_stringPart))-1|
|Filter out values from the column that are in the List|= Table.SelectRows( Volia_Team_ShP_,Â  (x)=>not(List.Contains(__listToExclude, x[#"Name Ukr"])))|
|BulkRenameColumns<br><br>=) )))Â  )) )))) ))|Table.RenameColumns(Custom, List.Zip({__oldColumnNames, __newColumnNames}))<br><br>For the case when not all columnNames from OldList exist in the Table:<br><br>\|   \|<br>\|---\|<br>\|__existingColumns = Table.ColumnNames(#"(ğŸ› ï¸)=>ParseApiResp"),<br><br>Â  __validOldColumns = List.Intersect({__oldColumnNames, __existingColumns}),<br><br>Â  __RenameZip = List.Zip({__validOldColumns, List.Transform(__validOldColumns, (val)=>(<br><br>Â  Â  __newColumnNames{List.PositionOf(__oldColumnNames, val)}<br><br>))}),<br><br>Â  #"(ğŸ…°ï¸)=> RenameColumns" = Table.RenameColumns(#"(ğŸ› ï¸)=>ParseApiResp", __RenameZip)\||
|Fn_BulkRenameColumns_IFEX|(__table as table, __oldColumnNames as list, __newColumnNames as list)=><br><br>let<br><br>Â Â Â  __existingColumns = Table.ColumnNames(__table),<br><br>Â Â Â  __validOldColumns = List.Intersect({__oldColumnNames, __existingColumns}),<br><br>Â Â Â  __zipList = List.Zip({__validOldColumns, List.Transform(__validOldColumns, (val)=>(<br><br>Â Â Â Â Â Â Â  __newColumnNames{List.PositionOf(__oldColumnNames, val)}<br><br>Â Â Â  ))}),<br><br>Â Â Â  return = Table.RenameColumns(__table, __zipList)<br><br>in<br><br>Â Â Â  return|
|Fn_BulkRenameColumns<br><br>(with list of lists)|(__Table as table, __currColNames as list, __newColNames as list) as table =><br><br>let<br><br>Â Â Â  #"ğŸ“† Table Of RenameCols" =<br><br>Â Â Â Â Â Â Â  Table.RenameColumns(<br><br>Â Â Â Â Â Â Â Â Â Â Â  Table.Transpose(<br><br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Table.FromRows({__currColNames, __newColNames})),<br><br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  {<br><br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  {"Column1", "OldVal"},<br><br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  {"Column2", "NewVal"}<br><br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  }<br><br>Â Â Â Â Â Â Â  ),<br><br>Â Â Â  #"ğŸ…°ï¸ [NewVal] --> kill Commaz" = Table.TransformColumns(#"ğŸ“† Table Of RenameCols",{{"NewVal", (x)=>Text.Replace(x, ",", ""), type text}}),Â <br><br>Â Â Â  __ListRen = List.Transform(Table.ToList(#"ğŸ…°ï¸ [NewVal] --> kill Commaz"), (x)=>Text.Split(x, ",")),<br><br>Â Â Â  Result = Table.RenameColumns(__Table, __ListRen)<br><br>in<br><br>Â Â Â  Result|
|TableUpdateColumn<br><br>[[source](https://answers.microsoft.com/en-us/msoffice/forum/all/power-query-get-transform-tabletransformcolumns/cd4956cb-9024-439e-8cf3-ecb43ac27cb0)]<br><br>Function<br><br>Fn_TableUpdateColumn|//https://answers.microsoft.com/en-us/msoffice/forum/all/power-query-get-transform-tabletransformcolumns/cd4956cb-9024-439e-8cf3-ecb43ac27cb0<br><br>(inTable as table, colToTransform as text, transformFunc as function, optional colType as type) as table =><br><br>Â Â Â  let<br><br>Â Â Â Â Â Â Â  ColumnsOrder = Table.ColumnNames(inTable),<br><br>Â Â Â Â Â Â Â  TempName = Text.NewGuid(),<br><br>Â Â Â Â Â Â Â  InsertedCustom = Table.AddColumn(inTable, TempName, transformFunc, colType),<br><br>Â Â Â Â Â Â Â  RemovedColumn = Table.RemoveColumns(InsertedCustom, {colToTransform}),<br><br>Â Â Â Â Â Â Â  RenamedColumn = Table.RenameColumns(RemovedColumn, {{TempName, colToTransform}})<br><br>Â Â Â  in<br><br>Â Â Â Â Â Â Â  Table.ReorderColumns(RenamedColumn, ColumnsOrder)|
|Fn_Get_JSON_value|(sourceTable as table, columnName as text, val2Extract as text) as table =><br><br>let<br><br>Â Â Â  Source = sourceTable,<br><br>Â Â Â  #"ğŸ…°ï¸ RV [" = Table.ReplaceValue(Source,"[","",Replacer.ReplaceText,{columnName}),<br><br>Â Â Â  #"ğŸ…°ï¸ RV ]" = Table.ReplaceValue(#"ğŸ…°ï¸ RV [","]","",Replacer.ReplaceText,{columnName}),<br><br>Â Â Â Â Â  #"ğŸ…°ï¸ RV null" = Table.ReplaceValue(#"ğŸ…°ï¸ RV ]","","{'" & val2Extract & "':'null'}",Replacer.ReplaceValue,{columnName}),<br><br>Â Â Â  #"ğŸ…°ï¸ RV '" = Table.ReplaceValue(#"ğŸ…°ï¸ RV null","'","""",Replacer.ReplaceText,{columnName}),<br><br>Â Â Â  #"ğŸ…°ï¸ RV False" = Table.ReplaceValue(#"ğŸ…°ï¸ RV '","False","""false""",Replacer.ReplaceText,{columnName}),<br><br>Â Â Â  #"ğŸ…°ï¸ RV True" = Table.ReplaceValue(#"ğŸ…°ï¸ RV False","True","""true""",Replacer.ReplaceText,{columnName}),<br><br>Â Â Â  #"(ğŸ› ï¸)=> Getting JSON value" = Table.TransformColumns(#"ğŸ…°ï¸ RV True",{{columnName, (v)=>Record.Field(Json.Document(v), val2Extract), type text}})<br><br>in<br><br>Â Â Â  #"(ğŸ› ï¸)=> Getting JSON value"|
|Create Table from Lists|let<br><br>Â Â Â  __versions = {"2.0"},<br><br>Â Â Â  __jiraLinks = {"[https://cats.mil.ua/browse/PBU-424](https://cats.mil.ua/browse/PBU-424)"},<br><br>Â Â Â  #"ğŸ› ï¸ CreateTable" = Table.FromColumns({__versions, __jiraLinks}, {"versions", "jiraLinks"})<br><br>in<br><br>Â Â Â  #"ğŸ› ï¸ CreateTable"|
|Accessing full content of Excel, not only tables|let<br><br>Â Â Â  Source = SharePoint.Files("https://findepumodoutlook.sharepoint.com/sites/MilTeam-Leadership", [ApiVersion = 15]),<br><br>Â Â Â  #"Talants xlsx_https://findepumodoutlook sharepoint com/sites/MilTeam-Leadership/Shared Documents/Workload/" = Source{[Name="Talants.xlsx",#"Folder Path"="https://findepumodoutlook.sharepoint.com/sites/MilTeam-Leadership/Shared Documents/Workload/"]}[Content],<br><br>Â Â Â  #"Imported Excel Workbook" = Excel.Workbook(#"Talants xlsx_https://findepumodoutlook sharepoint com/sites/MilTeam-Leadership/Shared Documents/Workload/"),<br><br>Â Â Â  #"People List Query_Sheet" = #"Imported Excel Workbook"{[Item="People List Query",Kind="Sheet"]}[Data],<br><br>Â Â Â  #"Promoted Headers" = Table.PromoteHeaders(#"People List Query_Sheet", [PromoteAllScalars=true]),<br><br>Â Â Â  #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"First name Last name #(lf)(as in Foreign passport)", type text}, {"ĞŸÑ€Ñ–Ğ·Ğ²Ğ¸Ñ‰Ğµ Ğ†Ğ¼'Ñ ĞŸĞ¾-Ğ±Ğ°Ñ‚ÑŒĞºĞ¾Ğ²Ñ– #(lf)(Ğ£ĞºÑ€Ğ°Ñ—Ğ½ÑÑŒĞºĞ¾Ñ)", type text}, {"Status", type text}, {"â„–Ğ½Ğ°ĞºĞ°Ğ·Ñƒ/Ğ²Ñ–Ğ´Ğ½Ğ¾ÑˆĞµĞ½Ğ½Ñ", type text}, {"Level", type text}, {"Practice", type text}, {"Primary skill", type text}, {"Secondary skill", type text}, {"Email", type text}})<br><br>in<br><br>Â Â Â  #"Changed Type"|
|Power Query List.Transform() -- change data type for columns in list|[Solved: Change column types dynamically - Microsoft Fabric Community](https://community.fabric.microsoft.com/t5/Power-Query/Change-column-types-dynamically/td-p/1925767)<br><br>#"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",  <br>Â Â Â Â Â  List.Transform(  <br>Â Â Â Â Â Â Â Â Â  List.RemoveFirstN(  <br>Â Â Â Â Â Â Â Â Â Â Â Â Â  Table.ColumnNames(Source),  <br>Â Â Â Â Â Â Â Â Â Â Â Â Â  13  <br>Â Â Â  ),  <br>Â Â Â Â Â  each {_, Currency.Type}  <br>Â Â Â  ))<br><br>From <[https://community.fabric.microsoft.com/t5/Power-Query/Change-column-types-dynamically/td-p/1925767](https://community.fabric.microsoft.com/t5/Power-Query/Change-column-types-dynamically/td-p/1925767)>|
|Using var as a columnName|= Table.AddColumn(#"RenC [CurrWeek] --> _old", __CurrWeekColName, each if [Current Projects] = "bench" then 1 else Record.Field(_, __CurrWeekColName_Old))<br><br>\|   \|   \|<br>\|---\|---\|<br>\|letÂ <br><br>Â Â Â  Source = Table1,Â <br><br>Â Â Â  VarColumnName = "HC-2 Score",Â <br><br>Â Â Â  #"Added Conditional Column" = Table.AddColumn(Source, "Test Score", eachÂ <br><br>Â Â Â Â Â Â Â  if [Job Title] = "DIRECTOR" then Record.Field(_, VarColumnName) else nullÂ <br><br>Â Â Â  )Â <br><br>inÂ <br><br>Â Â Â  #"Added Conditional Column"\|[[go](http://let)]\||
|Remove TimeZone|\|   \|   \|<br>\|---\|---\|<br>\|DateTimeZone.RemoveZone()<br><br>[[SOF](https://community.fabric.microsoft.com/t5/Power-Query/Convert-a-columns-of-datatype-datetimezone-to-datetime/td-p/1279621)]\|let<br><br>Â Â Â  dtz = ...,<br><br>Â Â Â  udtz = DateTimeZone.SwitchZone(dtz, 0),<br><br>Â Â Â  dt = DateTimeZone.RemoveZone(udtz)<br><br>in<br><br>Â Â Â  dt\||