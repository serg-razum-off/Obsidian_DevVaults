|   |   |
|---|---|
|API call with token|let<br><br>    url = "[https://postgrest-camunda-dev.oak.in.ua/workload"](https://postgrest-camunda-dev.oak.in.ua/workload%22),<br><br>    headers = [#"Authorization" = "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoicmFjY2VzcyJ9.ppTyrI17E3L456eVlAun8BML4mwzn7sYh0h8h5jkXDQ"],<br><br>    response = Web.Contents(<br><br>        url,<br><br>        [<br><br>            Headers = headers<br><br>        ]<br><br>    ),<br><br>    jsonResponse = Json.Document(response),<br><br>    #"Converted to Table" = Table.FromRecords(jsonResponse)<br><br>in<br><br>    #"Converted to Table"|
|Fn__DatereRreshed|()=><br><br>= DateTimeZone.ToText( DateTimeZone.SwitchZone( DateTimeZone.FixedUtcNow(), 2 ), [Format="dd-mm-yyyy HH:mm"])|
|Create empty Table|#table(<br><br>     Get_OPO_Pers_ColNames ,    // list of ColNames<br><br>     {<br><br>        List.Repeat({null}, List.Count(Get_OPO_Pers_ColNames))<br><br>     } // each record represents a row<br><br>)|
|Fn_ReplaceListOfValsInDiffCollumns<br><br>(based on List Accumulate)a|(_T_sourceTable, __oldValParam as list, __newValParam as list, __columnsToReplValParam as list) as table =><br><br>let<br><br>    __oldValues = __oldValParam,<br><br>    __newValues = __newValParam,<br><br>    __mappingTable = Fn_BulkRenameColumns( Table.Transpose( Table.FromRows({__oldValues, __newValues})), {"Column1", "Column2"}, {"Old", "New"}),<br><br>    __columnsToProcess = __columnsToReplValParam,<br><br>    LA = List.Accumulate(<br><br>        Table.ToRecords(__mappingTable) , //enum == iteration object<br><br>        _T_sourceTable,                   // seed == StartingTable      <br><br>                                          // function                      <br><br>        (OutputTable, oldNewPair)=><br><br>        (<br><br>            Table.ReplaceValue(OutputTable, oldNewPair[Old], oldNewPair[New], Replacer.ReplaceValue, __columnsToProcess )<br><br>        )<br><br>)<br><br>in<br><br>    LA|
|Parse all API response in one step (with List Accumulate)|List.Accumulate(<br><br>    __tableFieldsList,<br><br>    #"💽⏬Exp fields",<br><br>    (outTable, colName)=>(<br><br>        Table.TransformColumns(outTable,<br><br>            {{colName, (val)=>(<br><br>                    if val = null then null else<br><br>                    if Type.Is(Value.Type(val), type list) then Text.Combine(val, ",") else<br><br>                    if Type.Is(Value.Type(val), type record) and Record.HasFields(val, {"value"}) then val[value] else<br><br>                    if Type.Is(Value.Type(val), type record) and Record.HasFields(val, {"name"}) then val[name] else<br><br>                        val<br><br>                )}}<br><br>        )<br><br>    )<br><br>)|
|Function to count occurrence in text<br><br>From <[https://stackoverflow.com/questions/44268075/is-there-a-simple-way-to-count-occurences-of-one-text-string-within-another-text](https://stackoverflow.com/questions/44268075/is-there-a-simple-way-to-count-occurences-of-one-text-string-within-another-text)>|(_string, _stringPart) =><br><br>List.Count(Text.Split(_string,_stringPart))-1|
|Filter out values from the column that are in the List|= Table.SelectRows( Volia_Team_ShP_,  (x)=>not(List.Contains(__listToExclude, x[#"Name Ukr"])))|
|BulkRenameColumns<br><br>=) )))  )) )))) ))|Table.RenameColumns(Custom, List.Zip({__oldColumnNames, __newColumnNames}))<br><br>For the case when not all columnNames from OldList exist in the Table:<br><br>\|   \|<br>\|---\|<br>\|__existingColumns = Table.ColumnNames(#"(🛠️)=>ParseApiResp"),<br><br>  __validOldColumns = List.Intersect({__oldColumnNames, __existingColumns}),<br><br>  __RenameZip = List.Zip({__validOldColumns, List.Transform(__validOldColumns, (val)=>(<br><br>    __newColumnNames{List.PositionOf(__oldColumnNames, val)}<br><br>))}),<br><br>  #"(🅰️)=> RenameColumns" = Table.RenameColumns(#"(🛠️)=>ParseApiResp", __RenameZip)\||
|Fn_BulkRenameColumns_IFEX|(__table as table, __oldColumnNames as list, __newColumnNames as list)=><br><br>let<br><br>    __existingColumns = Table.ColumnNames(__table),<br><br>    __validOldColumns = List.Intersect({__oldColumnNames, __existingColumns}),<br><br>    __zipList = List.Zip({__validOldColumns, List.Transform(__validOldColumns, (val)=>(<br><br>        __newColumnNames{List.PositionOf(__oldColumnNames, val)}<br><br>    ))}),<br><br>    return = Table.RenameColumns(__table, __zipList)<br><br>in<br><br>    return|
|Fn_BulkRenameColumns<br><br>(with list of lists)|(__Table as table, __currColNames as list, __newColNames as list) as table =><br><br>let<br><br>    #"📆 Table Of RenameCols" =<br><br>        Table.RenameColumns(<br><br>            Table.Transpose(<br><br>                Table.FromRows({__currColNames, __newColNames})),<br><br>                {<br><br>                    {"Column1", "OldVal"},<br><br>                    {"Column2", "NewVal"}<br><br>                }<br><br>        ),<br><br>    #"🅰️ [NewVal] --> kill Commaz" = Table.TransformColumns(#"📆 Table Of RenameCols",{{"NewVal", (x)=>Text.Replace(x, ",", ""), type text}}), <br><br>    __ListRen = List.Transform(Table.ToList(#"🅰️ [NewVal] --> kill Commaz"), (x)=>Text.Split(x, ",")),<br><br>    Result = Table.RenameColumns(__Table, __ListRen)<br><br>in<br><br>    Result|
|TableUpdateColumn<br><br>[[source](https://answers.microsoft.com/en-us/msoffice/forum/all/power-query-get-transform-tabletransformcolumns/cd4956cb-9024-439e-8cf3-ecb43ac27cb0)]<br><br>Function<br><br>Fn_TableUpdateColumn|//https://answers.microsoft.com/en-us/msoffice/forum/all/power-query-get-transform-tabletransformcolumns/cd4956cb-9024-439e-8cf3-ecb43ac27cb0<br><br>(inTable as table, colToTransform as text, transformFunc as function, optional colType as type) as table =><br><br>    let<br><br>        ColumnsOrder = Table.ColumnNames(inTable),<br><br>        TempName = Text.NewGuid(),<br><br>        InsertedCustom = Table.AddColumn(inTable, TempName, transformFunc, colType),<br><br>        RemovedColumn = Table.RemoveColumns(InsertedCustom, {colToTransform}),<br><br>        RenamedColumn = Table.RenameColumns(RemovedColumn, {{TempName, colToTransform}})<br><br>    in<br><br>        Table.ReorderColumns(RenamedColumn, ColumnsOrder)|
|Fn_Get_JSON_value|(sourceTable as table, columnName as text, val2Extract as text) as table =><br><br>let<br><br>    Source = sourceTable,<br><br>    #"🅰️ RV [" = Table.ReplaceValue(Source,"[","",Replacer.ReplaceText,{columnName}),<br><br>    #"🅰️ RV ]" = Table.ReplaceValue(#"🅰️ RV [","]","",Replacer.ReplaceText,{columnName}),<br><br>      #"🅰️ RV null" = Table.ReplaceValue(#"🅰️ RV ]","","{'" & val2Extract & "':'null'}",Replacer.ReplaceValue,{columnName}),<br><br>    #"🅰️ RV '" = Table.ReplaceValue(#"🅰️ RV null","'","""",Replacer.ReplaceText,{columnName}),<br><br>    #"🅰️ RV False" = Table.ReplaceValue(#"🅰️ RV '","False","""false""",Replacer.ReplaceText,{columnName}),<br><br>    #"🅰️ RV True" = Table.ReplaceValue(#"🅰️ RV False","True","""true""",Replacer.ReplaceText,{columnName}),<br><br>    #"(🛠️)=> Getting JSON value" = Table.TransformColumns(#"🅰️ RV True",{{columnName, (v)=>Record.Field(Json.Document(v), val2Extract), type text}})<br><br>in<br><br>    #"(🛠️)=> Getting JSON value"|
|Create Table from Lists|let<br><br>    __versions = {"2.0"},<br><br>    __jiraLinks = {"[https://cats.mil.ua/browse/PBU-424](https://cats.mil.ua/browse/PBU-424)"},<br><br>    #"🛠️ CreateTable" = Table.FromColumns({__versions, __jiraLinks}, {"versions", "jiraLinks"})<br><br>in<br><br>    #"🛠️ CreateTable"|
|Accessing full content of Excel, not only tables|let<br><br>    Source = SharePoint.Files("https://findepumodoutlook.sharepoint.com/sites/MilTeam-Leadership", [ApiVersion = 15]),<br><br>    #"Talants xlsx_https://findepumodoutlook sharepoint com/sites/MilTeam-Leadership/Shared Documents/Workload/" = Source{[Name="Talants.xlsx",#"Folder Path"="https://findepumodoutlook.sharepoint.com/sites/MilTeam-Leadership/Shared Documents/Workload/"]}[Content],<br><br>    #"Imported Excel Workbook" = Excel.Workbook(#"Talants xlsx_https://findepumodoutlook sharepoint com/sites/MilTeam-Leadership/Shared Documents/Workload/"),<br><br>    #"People List Query_Sheet" = #"Imported Excel Workbook"{[Item="People List Query",Kind="Sheet"]}[Data],<br><br>    #"Promoted Headers" = Table.PromoteHeaders(#"People List Query_Sheet", [PromoteAllScalars=true]),<br><br>    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"First name Last name #(lf)(as in Foreign passport)", type text}, {"Прізвище Ім'я По-батькові #(lf)(Українською)", type text}, {"Status", type text}, {"№наказу/відношення", type text}, {"Level", type text}, {"Practice", type text}, {"Primary skill", type text}, {"Secondary skill", type text}, {"Email", type text}})<br><br>in<br><br>    #"Changed Type"|
|Power Query List.Transform() -- change data type for columns in list|[Solved: Change column types dynamically - Microsoft Fabric Community](https://community.fabric.microsoft.com/t5/Power-Query/Change-column-types-dynamically/td-p/1925767)<br><br>#"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",  <br>      List.Transform(  <br>          List.RemoveFirstN(  <br>              Table.ColumnNames(Source),  <br>              13  <br>    ),  <br>      each {_, Currency.Type}  <br>    ))<br><br>From <[https://community.fabric.microsoft.com/t5/Power-Query/Change-column-types-dynamically/td-p/1925767](https://community.fabric.microsoft.com/t5/Power-Query/Change-column-types-dynamically/td-p/1925767)>|
|Using var as a columnName|= Table.AddColumn(#"RenC [CurrWeek] --> _old", __CurrWeekColName, each if [Current Projects] = "bench" then 1 else Record.Field(_, __CurrWeekColName_Old))<br><br>\|   \|   \|<br>\|---\|---\|<br>\|let <br><br>    Source = Table1, <br><br>    VarColumnName = "HC-2 Score", <br><br>    #"Added Conditional Column" = Table.AddColumn(Source, "Test Score", each <br><br>        if [Job Title] = "DIRECTOR" then Record.Field(_, VarColumnName) else null <br><br>    ) <br><br>in <br><br>    #"Added Conditional Column"\|[[go](http://let)]\||
|Remove TimeZone|\|   \|   \|<br>\|---\|---\|<br>\|DateTimeZone.RemoveZone()<br><br>[[SOF](https://community.fabric.microsoft.com/t5/Power-Query/Convert-a-columns-of-datatype-datetimezone-to-datetime/td-p/1279621)]\|let<br><br>    dtz = ...,<br><br>    udtz = DateTimeZone.SwitchZone(dtz, 0),<br><br>    dt = DateTimeZone.RemoveZone(udtz)<br><br>in<br><br>    dt\||